import{_ as n,c as s,o as a,a as t}from"./app-CLjztbUh.js";const e={},o=t('<h1 id="框架模型" tabindex="-1"><a class="header-anchor" href="#框架模型"><span>框架模型</span></a></h1><h3 id="模型基础" tabindex="-1"><a class="header-anchor" href="#模型基础"><span>模型基础</span></a></h3><p>框架内置了有关审批框架的默认模型定义，风格完全适配goravel，具体如下。</p><h4 id="template流程模板" tabindex="-1"><a class="header-anchor" href="#template流程模板"><span>Template流程模板</span></a></h4><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Template <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	TemplateName  <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:template_name;not null;default:&#39;&#39;&quot; json:&quot;template_name&quot;`</span></span>\n<span class="line">	TemplateForms <span class="token punctuation">[</span><span class="token punctuation">]</span>TemplateForm</span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>流程模板:流程模板定义了有关审批框架的字段设计，并为模板取名以识别。</p><h4 id="templateform流程模板表单" tabindex="-1"><a class="header-anchor" href="#templateform流程模板表单"><span>TemplateForm流程模板表单</span></a></h4><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> TemplateForm <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	Field             <span class="token builtin">string</span>            <span class="token string">`gorm:&quot;column:field;not null;default:&#39;&#39;;comment:&#39;表单字段英文名&#39;&quot; json:&quot;field&quot; form:&quot;field&quot;`</span></span>\n<span class="line">	FieldName         <span class="token builtin">string</span>            <span class="token string">`gorm:&quot;column:field_name;not null;default:&#39;&#39;;comment:&#39;表单字段中文名&#39;&quot; json:&quot;field_name&quot; form:&quot;field_name&quot;`</span></span>\n<span class="line">	FieldType         <span class="token builtin">string</span>            <span class="token string">`gorm:&quot;column:field_type;not null;default:&#39;&#39;;comment:&#39;表单字段类型&#39;&quot; json:&quot;field_type&quot; form:&quot;field_type&quot;`</span></span>\n<span class="line">	FieldValue        common<span class="token punctuation">.</span>FieldValue <span class="token string">`gorm:&quot;column:field_value;type:text;comment:&#39;表单字段值，select radio checkbox用&#39;&quot; json:&quot;field_value&quot; form:&quot;field_value&quot;`</span></span>\n<span class="line">	FieldDefaultValue <span class="token builtin">string</span>            <span class="token string">`gorm:&quot;column:field_default_value;type:text;comment:&#39;表单字段默认值&#39;&quot; json:&quot;field_default_value&quot; form:&quot;field_default_value&quot;`</span></span>\n<span class="line">	FieldRules        common<span class="token punctuation">.</span>Rule       <span class="token string">`gorm:&quot;column:field_rules;&quot; json:&quot;field_rules&quot; form:&quot;field_rules&quot;`</span></span>\n<span class="line">	Sort              <span class="token builtin">int</span>               <span class="token string">`gorm:&quot;column:sort;not null;default:100;comment:&#39;排序&#39;&quot; json:&quot;sort&quot; form:&quot;sort&quot;`</span></span>\n<span class="line">	TemplateID        <span class="token builtin">uint</span>              <span class="token string">`gorm:&quot;column:template_id;not null;default:0;comment:&#39;模板ID&#39;&quot; json:&quot;template_id&quot; form:&quot;template_id&quot;`</span></span>\n<span class="line">	Template          Template</span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>模板字段：为每一个流程模板设置了字段选项，且与template保持一对多关系。<code>Template:TemplateForm = 1:n</code></p><h4 id="dept部门模型" tabindex="-1"><a class="header-anchor" href="#dept部门模型"><span>Dept部门模型</span></a></h4><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Dept <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	DeptName   <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:dept_name;not null;default:&#39;&#39;&quot; json:&quot;dept_name&quot;`</span></span>\n<span class="line">	Pid        <span class="token builtin">uint</span>   <span class="token string">`gorm:&quot;column:pid;not null;default:0&quot; json:&quot;pid&quot;`</span></span>\n<span class="line">	DirectorID <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:director_id;not null;default:0&quot; json:&quot;director_id&quot;`</span> <span class="token comment">// 部门主管</span></span>\n<span class="line">	ManagerID  <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:manager_id;not null;default:0&quot; json:&quot;manager_id&quot;`</span>   <span class="token comment">// 部门经理</span></span>\n<span class="line">	Rank       <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:rank;not null;default:1&quot; json:&quot;rank&quot;`</span></span>\n<span class="line">	Html       <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:html;null;default:&#39;&#39;&quot; json:&quot;html&quot;`</span></span>\n<span class="line">	Level      <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:level;null;default:0&quot; json:&quot;level&quot;`</span></span>\n<span class="line">	Director   <span class="token operator">*</span>Emp   <span class="token string">`gorm:&quot;foreignkey:DirectorID&quot;`</span> <span class="token comment">// 关联主管</span></span>\n<span class="line">	Manager    <span class="token operator">*</span>Emp   <span class="token string">`gorm:&quot;foreignkey:ManagerID&quot;`</span>  <span class="token comment">// 关联经理</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>部门：部门模型定义了部门的基本信息，且内置部门主管和部门经理和部门主管2个职位，部门层级为树状结构。</p><h4 id="emp员工模型" tabindex="-1"><a class="header-anchor" href="#emp员工模型"><span>Emp员工模型</span></a></h4><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Emp <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	Name     <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:name;not null&quot; json:&quot;name&quot; form:&quot;name&quot;`</span></span>\n<span class="line">	Email    <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:email;not null;unique_index:users_email_unique&quot; json:&quot;email&quot; form:&quot;email&quot;`</span></span>\n<span class="line">	Password <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:password;not null&quot; json:&quot;-&quot; form:&quot;password&quot;`</span> <span class="token comment">// Exclude password from JSON response</span></span>\n<span class="line">	WorkNo   <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:workno;not null;unique_index:users_workno_unique&quot; json:&quot;workno&quot; form:&quot;workno&quot;`</span></span>\n<span class="line">	DeptID   <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:dept_id;not null;default:0&quot; json:&quot;dept_id&quot; form:&quot;dept_id&quot;`</span></span>\n<span class="line">	Leave    <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:leave;not null;default:0&quot; json:&quot;leave&quot; form:&quot;leave&quot;`</span></span>\n<span class="line">	UserID   <span class="token builtin">uint</span>   <span class="token string">`gorm:&quot;column:user_id;&quot; json:&quot;user_id&quot; form:&quot;user_id&quot;`</span></span>\n<span class="line">	Dept     Dept   <span class="token string">`json:&quot;Dept&quot;`</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>员工：员工模型与部门保持一对多关系，Dept:Emp=1:n</p><h3 id="定义工作流" tabindex="-1"><a class="header-anchor" href="#定义工作流"><span>定义工作流</span></a></h3><h3 id="flow工作流模型" tabindex="-1"><a class="header-anchor" href="#flow工作流模型"><span>Flow工作流模型</span></a></h3><p><code>flow</code>模型为流程框架基础模型工作流模型，其中字段<code>jsplumb</code>由前端组件可视化生成，详见<a href="https://github.com/hulutech-web/goravel-workflow-vue" target="_blank" rel="noopener noreferrer">goravel-workflow-vue</a>。</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Flow <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	FlowNo      <span class="token builtin">string</span>       <span class="token string">`gorm:&quot;column:flow_no;not null&quot; json:&quot;flow_no&quot; form:&quot;flow_no&quot;`</span></span>\n<span class="line">	FlowName    <span class="token builtin">string</span>       <span class="token string">`gorm:&quot;column:flow_name;not null;default:&#39;&#39;&quot; json:&quot;flow_name&quot; form:&quot;flow_name&quot;`</span></span>\n<span class="line">	TemplateID  <span class="token builtin">int</span>          <span class="token string">`gorm:&quot;column:template_id;not null;default:0&quot; json:&quot;template_id&quot; form:&quot;template_id&quot;`</span></span>\n<span class="line">	Flowchart   <span class="token builtin">string</span>       <span class="token string">`gorm:&quot;column:flowchart&quot; json:&quot;flowchart&quot; form:&quot;flowchart&quot;`</span></span>\n<span class="line">	Jsplumb     <span class="token builtin">string</span>       <span class="token string">`gorm:&quot;column:jsplumb;comment:&#39;jsplumb流程图数据&#39;&quot; json:&quot;jsplumb&quot; form:&quot;jsplumb&quot;`</span></span>\n<span class="line">	TypeID      <span class="token builtin">int</span>          <span class="token string">`gorm:&quot;column:type_id;not null;default:0&quot; json:&quot;type_id&quot; form:&quot;type_id&quot;`</span></span>\n<span class="line">	IsPublish   <span class="token builtin">bool</span>         <span class="token string">`gorm:&quot;column:is_publish;not null;default:0&quot; json:&quot;is_publish&quot; form:&quot;is_publish&quot;`</span></span>\n<span class="line">	IsShow      <span class="token builtin">bool</span>         <span class="token string">`gorm:&quot;column:is_show;not null;default:1&quot; json:&quot;is_show&quot; form:&quot;is_show&quot;`</span></span>\n<span class="line">	Processes   <span class="token punctuation">[</span><span class="token punctuation">]</span>Process    <span class="token string">`gorm:&quot;foreignKey:FlowID&quot;`</span>     <span class="token comment">// HasMany Process</span></span>\n<span class="line">	ProcessVars <span class="token punctuation">[</span><span class="token punctuation">]</span>ProcessVar <span class="token string">`gorm:&quot;foreignKey:FlowID&quot;`</span>     <span class="token comment">// HasMany ProcessVar</span></span>\n<span class="line">	Template    Template     <span class="token string">`gorm:&quot;foreignKey:TemplateID&quot;`</span> <span class="token comment">// BelongsTo Template</span></span>\n<span class="line">	Flowtype    Flowtype     <span class="token string">`gorm:&quot;foreignKey:TypeID&quot;`</span>     <span class="token comment">// BelongsTo FlowType</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="flowtype工作流类型" tabindex="-1"><a class="header-anchor" href="#flowtype工作流类型"><span>Flowtype工作流类型</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Flowtype <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	TypeName <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:type_name;not null;default:&#39;&#39;&quot; json:&quot;type_name&quot;`</span></span>\n<span class="line">	Flows    <span class="token punctuation">[</span><span class="token punctuation">]</span>Flow <span class="token string">`gorm:&quot;-&quot;`</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="flowlink流程步骤流转轨迹" tabindex="-1"><a class="header-anchor" href="#flowlink流程步骤流转轨迹"><span>Flowlink流程步骤流转轨迹</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Flowlink <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	Type       <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:type;not null;comment:&#39;Condition:表示步骤流转\\\\nRole:当前步骤操作人&#39;&quot;`</span>                             <span class="token comment">// 类型：Condition或Role</span></span>\n<span class="line">	Auditor    <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:auditor;not null;default:&#39;0&#39;;comment:&#39;审批人 系统自动 指定人员 指定部门 指定角色\\\\ntype=Condition时不启用&#39;&quot;`</span> <span class="token comment">// 审批人设置</span></span>\n<span class="line">	Expression <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:expression;not null;default:&#39;&#39;;comment:&#39;条件判断表达式\\\\n为1表示true，通过的话直接进入下一步骤&#39;&quot;`</span>            <span class="token comment">// 条件判断表达式</span></span>\n<span class="line">	Sort       <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:sort;not null;comment:&#39;条件判断顺序&#39;&quot;`</span>                                                      <span class="token comment">// 判断顺序</span></span>\n<span class="line"></span>\n<span class="line">	FlowID        <span class="token builtin">uint</span>    <span class="token string">`gorm:&quot;column:flow_id&quot;`</span>                         <span class="token comment">// 流程ID</span></span>\n<span class="line">	ProcessID     <span class="token builtin">uint</span>    <span class="token string">`gorm:&quot;column:process_id&quot;`</span>                      <span class="token comment">// 当前步骤ID</span></span>\n<span class="line">	NextProcessID <span class="token builtin">int</span>     <span class="token string">`gorm:&quot;column:next_process_id;default:2&quot;`</span>       <span class="token comment">// 下一步骤ID</span></span>\n<span class="line">	Process       Process <span class="token string">`gorm:&quot;foreignKey:ProcessID;references:id&quot;`</span>     <span class="token comment">// HasOne Process</span></span>\n<span class="line">	NextProcess   Process <span class="token string">`gorm:&quot;foreignKey:NextProcessID;references:id&quot;`</span> <span class="token comment">// HasOne NextProcess</span></span>\n<span class="line">	Flow          Flow    <span class="token string">`gorm:&quot;foreignKey:FlowID;references:id&quot;`</span>        <span class="token comment">// BelongsTo Flow</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Flowlink</code>模型定义了审批步骤间的关系，Auditor字段指示了审批人信息。</p><h3 id="process流程步骤" tabindex="-1"><a class="header-anchor" href="#process流程步骤"><span>Process流程步骤</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Process <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	FlowID           <span class="token builtin">int</span>       <span class="token string">`gorm:&quot;column:flow_id;not null;default:0;comment:&#39;流程id&#39;&quot; json:&quot;flow_id&quot;`</span></span>\n<span class="line">	ProcessName      <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:process_name;not null;default:&#39;&#39;;comment:&#39;步骤名称&#39;&quot; json:&quot;process_name&quot;`</span></span>\n<span class="line">	LimitTime        <span class="token builtin">int</span>       <span class="token string">`gorm:&quot;column:limit_time;not null;default:0;comment:&#39;限定时间,单位秒&#39;&quot; json:&quot;limit_time&quot;`</span></span>\n<span class="line">	Type             <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:type;not null;default:&#39;operation&#39;;comment:&#39;流程图显示操作框类型&#39;&quot; json:&quot;type&quot;`</span></span>\n<span class="line">	Icon             <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:icon;default:&#39;&#39;;comment:&#39;流程图显示图标&#39;&quot; json:&quot;icon,omitempty&quot;`</span></span>\n<span class="line">	ProcessTo        <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:process_to;not null;default:&#39;&#39;&quot; json:&quot;process_to&quot;`</span></span>\n<span class="line">	Style            <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:style;type:text;&quot; json:&quot;style,omitempty&quot;`</span></span>\n<span class="line">	StyleColor       <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:style_color;not null;default:&#39;#78a300&#39;&quot; json:&quot;style_color&quot;`</span></span>\n<span class="line">	StyleHeight      <span class="token builtin">int</span>       <span class="token string">`gorm:&quot;column:style_height;not null;default:30&quot; json:&quot;style_height&quot;`</span></span>\n<span class="line">	StyleWidth       <span class="token builtin">int</span>       <span class="token string">`gorm:&quot;column:style_width;not null;default:30&quot; json:&quot;style_width&quot;`</span></span>\n<span class="line">	PositionLeft     <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:position_left;not null;default:&#39;100px&#39;&quot; json:&quot;position_left&quot;`</span></span>\n<span class="line">	PositionTop      <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:position_top;not null;default:&#39;200px&#39;&quot; json:&quot;position_top&quot;`</span></span>\n<span class="line">	Position         <span class="token builtin">int</span>       <span class="token string">`gorm:&quot;column:position;not null;default:1;comment:&#39;步骤位置：1正常步骤2：转入子流程0：第一步 当为2时 child_flow_id child_after child_back_process 可设置&#39;&quot; json:&quot;position&quot;`</span></span>\n<span class="line">	ChildFlowID      <span class="token builtin">int</span>       <span class="token string">`gorm:&quot;column:child_flow_id;not null;default:0;comment:&#39;子流程id&#39;&quot; json:&quot;child_flow_id&quot;`</span></span>\n<span class="line">	ChildAfter       <span class="token builtin">int</span>       <span class="token string">`gorm:&quot;column:child_after;not null;default:2;comment:&#39;子流程结束后 1.同时结束父流程 2.返回父流程&#39;&quot; json:&quot;child_after&quot;`</span></span>\n<span class="line">	ChildBackProcess <span class="token builtin">int</span>       <span class="token string">`gorm:&quot;column:child_back_process;not null;default:0;comment:&#39;子流程结束后返回父流程进程&#39;&quot; json:&quot;child_back_process&quot;`</span></span>\n<span class="line">	Description      <span class="token builtin">string</span>    <span class="token string">`gorm:&quot;column:description;not null;default:&#39;&#39;;comment:&#39;步骤描述&#39;&quot; json:&quot;description&quot;`</span></span>\n<span class="line">	ProcessVars      <span class="token punctuation">[</span><span class="token punctuation">]</span>Process <span class="token string">`gorm:&quot;many2many:process_vars;&quot; json:&quot;process_vars&quot;`</span></span>\n<span class="line">	Flow             Flow</span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>流程步骤定义了流程框架中每一个步骤的相关配置，包含步骤名称，前端步骤展示样式，审批条件等信息</p><h3 id="processvar-步骤判断变量记录" tabindex="-1"><a class="header-anchor" href="#processvar-步骤判断变量记录"><span>ProcessVar 步骤判断变量记录</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> ProcessVar <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	ProcessID       <span class="token builtin">int</span>     <span class="token string">`gorm:&quot;column:process_id;not null&quot; json:&quot;process_id&quot;`</span></span>\n<span class="line">	FlowID          <span class="token builtin">int</span>     <span class="token string">`gorm:&quot;column:flow_id;not null;comment:&#39;流程id&#39;&quot; json:&quot;flow_id&quot;`</span></span>\n<span class="line">	ExpressionField <span class="token builtin">string</span>  <span class="token string">`gorm:&quot;column:expression_field;not null;comment:&#39;条件表达式字段名称&#39;&quot; json:&quot;expression_field&quot;`</span></span>\n<span class="line">	Process         Process <span class="token string">`gorm:&quot;foreignKey:ProcessID;references:ID&quot;`</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>保存：每一个流程步骤中，如果存在审批变量，则记录流程步骤中的变量信息与Process关系为:Process:ProcessVar=1:n</p><h3 id="发起工作流" tabindex="-1"><a class="header-anchor" href="#发起工作流"><span>发起工作流</span></a></h3><h3 id="entry模型" tabindex="-1"><a class="header-anchor" href="#entry模型"><span>Entry模型</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Entry <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	Title          <span class="token builtin">string</span>      <span class="token string">`gorm:&quot;column:title;not null;default:&#39;&#39;&quot; json:&quot;title&quot; form:&quot;title&quot;`</span></span>\n<span class="line">	FlowID         <span class="token builtin">uint</span>        <span class="token string">`gorm:&quot;column:flow_id;not null;default:0&quot; json:&quot;flow_id&quot; form:&quot;flow_id&quot;`</span></span>\n<span class="line">	EmpID          <span class="token builtin">uint</span>        <span class="token string">`gorm:&quot;column:emp_id;not null;default:0&quot; json:&quot;emp_id&quot; form:&quot;emp_id&quot;`</span></span>\n<span class="line">	ProcessID      <span class="token builtin">uint</span>        <span class="token string">`gorm:&quot;column:process_id;not null;default:0&quot; json:&quot;process_id&quot; form:&quot;process_id&quot;`</span></span>\n<span class="line">	Circle         <span class="token builtin">int</span>         <span class="token string">`gorm:&quot;column:circle;not null;default:1&quot; json:&quot;circle&quot; form:&quot;circle&quot;`</span></span>\n<span class="line">	Status         <span class="token builtin">int</span>         <span class="token string">`gorm:&quot;column:status;not_null&quot; json:&quot;status&quot; form:&quot;status&quot;`</span></span>\n<span class="line">	Pid            <span class="token builtin">int</span>         <span class="token string">`gorm:&quot;column:pid;not null;default:0&quot; json:&quot;pid&quot; form:&quot;pid&quot;`</span></span>\n<span class="line">	EnterProcessID <span class="token builtin">int</span>         <span class="token string">`gorm:&quot;column:enter_process_id;not null;default:0&quot; json:&quot;enter_process_id&quot; form:&quot;enter_process_id&quot;`</span></span>\n<span class="line">	EnterProcID    <span class="token builtin">int</span>         <span class="token string">`gorm:&quot;column:enter_proc_id;not null;default:0&quot; json:&quot;enter_proc_id&quot; form:&quot;enter_proc_id&quot;`</span></span>\n<span class="line">	Child          <span class="token builtin">int</span>         <span class="token string">`gorm:&quot;column:child;not null;default:0&quot; json:&quot;child&quot; form:&quot;child&quot;`</span></span>\n<span class="line">	Flow           Flow        <span class="token string">`gorm:&quot;foreignKey:flow_id&quot;`</span> <span class="token comment">// 关联的Flow</span></span>\n<span class="line">	Emp            Emp         <span class="token string">`gorm:&quot;foreignKey:emp_id&quot;`</span>  <span class="token comment">// 关联的Emp</span></span>\n<span class="line">	Procs          <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Proc     <span class="token comment">// HasMany Proc</span></span>\n<span class="line">	Process        Process     <span class="token string">`gorm:&quot;foreignKey:process_id&quot;`</span> <span class="token comment">// 关联的Process</span></span>\n<span class="line">	EntryDatas     <span class="token punctuation">[</span><span class="token punctuation">]</span>EntryData <span class="token comment">// HasMany EntryData</span></span>\n<span class="line">	ParentEntry    <span class="token operator">*</span>Entry      <span class="token string">`gorm:&quot;foreignKey:pid&quot;`</span>              <span class="token comment">// 关联的父Entry</span></span>\n<span class="line">	Children       <span class="token punctuation">[</span><span class="token punctuation">]</span>Entry     <span class="token string">`gorm:&quot;foreignKey:pid&quot;`</span>              <span class="token comment">// HasMany Entry, 级联删除</span></span>\n<span class="line">	EnterProcess   Process     <span class="token string">`gorm:&quot;foreignKey:enter_process_id&quot;`</span> <span class="token comment">// 关联的进入步骤Process</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>流程实例:流程实例代表发起了一个流程，他表示在框架中新发起了某一个流程。工作流模型定义了流程发起时，每一个流程实例的相关信息，包含流程实例名称，流程实例发起人，流程实例状态，流程实例关联的流程，流程实例关联的流程步骤，流程实例关联的流程步骤变量等信息</p></div><h3 id="entrydata实例数据模型" tabindex="-1"><a class="header-anchor" href="#entrydata实例数据模型"><span>EntryData实例数据模型</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> EntryData <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	EntryID     <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:entry_id;not null;default:0&quot; form:&quot;entry_id&quot; json:&quot;entry_id&quot;`</span></span>\n<span class="line">	FlowID      <span class="token builtin">int</span>    <span class="token string">`gorm:&quot;column:flow_id;not null;default:0&quot; form:&quot;flow_id&quot; json:&quot;flow_id&quot;`</span></span>\n<span class="line">	FieldName   <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:field_name;not null;default:&#39;&#39;&quot; form:&quot;field_name&quot; json:&quot;field_name&quot;`</span></span>\n<span class="line">	FieldValue  <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:field_value&quot; json:&quot;field_value&quot; form:&quot;field_value&quot; json:&quot;field_value&quot;`</span></span>\n<span class="line">	FieldRemark <span class="token builtin">string</span> <span class="token string">`gorm:&quot;column:field_remark;not null;default:&#39;&#39;&quot; form:&quot;field_remark&quot; json:&quot;field_remark&quot;`</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实例数据：保存提交流程是的表单数据，表单数据来源于按照template_form动态设计出来的表单字段内容。</p><h3 id="执行工作流" tabindex="-1"><a class="header-anchor" href="#执行工作流"><span>执行工作流</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Proc <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>\n<span class="line">	orm<span class="token punctuation">.</span>Model</span>\n<span class="line">	EntryID     <span class="token builtin">uint</span>            <span class="token string">`gorm:&quot;column:entry_id;not null&quot; json:&quot;entry_id&quot; form:&quot;entry_id&quot;`</span></span>\n<span class="line">	FlowID      <span class="token builtin">int</span>             <span class="token string">`gorm:&quot;column:flow_id;not null;comment:&#39;流程id&#39;&quot; json:&quot;flow_id&quot; form:&quot;flow_id&quot;`</span></span>\n<span class="line">	ProcessID   <span class="token builtin">int</span>             <span class="token string">`gorm:&quot;column:process_id;not null;comment:&#39;当前步骤&#39;&quot; json:&quot;process_id&quot; form:&quot;process_id&quot;`</span></span>\n<span class="line">	ProcessName <span class="token builtin">string</span>          <span class="token string">`gorm:&quot;column:process_name;not null;default:&#39;&#39;;comment:&#39;当前步骤名称&#39;&quot; json:&quot;process_name&quot; form:&quot;process_name&quot;`</span></span>\n<span class="line">	EmpID       <span class="token builtin">int</span>             <span class="token string">`gorm:&quot;column:emp_id;not null;comment:&#39;审核人&#39;&quot; json:&quot;emp_id&quot; form:&quot;emp_id&quot;`</span></span>\n<span class="line">	EmpName     <span class="token builtin">string</span>          <span class="token string">`gorm:&quot;column:emp_name;default:null;comment:&#39;审核人名称&#39;&quot; json:&quot;emp_name&quot; form:&quot;emp_name&quot;`</span></span>\n<span class="line">	DeptName    <span class="token builtin">string</span>          <span class="token string">`gorm:&quot;column:dept_name;default:null;comment:&#39;审核人部门名称&#39;&quot; json:&quot;dept_name&quot; form:&quot;dept_name&quot;`</span></span>\n<span class="line">	AuditorID   <span class="token builtin">int</span>             <span class="token string">`gorm:&quot;column:auditor_id;not null;default:0;comment:&#39;具体操作人&#39;&quot; json:&quot;auditor_id&quot; form:&quot;auditor_id&quot;`</span></span>\n<span class="line">	AuditorName <span class="token builtin">string</span>          <span class="token string">`gorm:&quot;column:auditor_name;not null;default:&#39;&#39;;comment:&#39;操作人名称&#39;&quot; json:&quot;auditor_name&quot; form:&quot;auditor_name&quot;`</span></span>\n<span class="line">	AuditorDept <span class="token builtin">string</span>          <span class="token string">`gorm:&quot;column:auditor_dept;not null;default:&#39;&#39;;comment:&#39;操作人部门&#39;&quot; json:&quot;auditor_dept&quot; form:&quot;auditor_dept&quot;`</span></span>\n<span class="line">	Status      <span class="token builtin">int</span>             <span class="token string">`gorm:&quot;column:status;not null;comment:&#39;当前处理状态 0待处理 9通过 -1驳回\\n0：处理中\\n-1：驳回\\n9：会签&#39;&quot; json:&quot;status&quot; form:&quot;status&quot;`</span></span>\n<span class="line">	Content     <span class="token builtin">string</span>          <span class="token string">`gorm:&quot;column:content;default:null;comment:&#39;批复内容&#39;&quot; json:&quot;content&quot; form:&quot;content&quot;`</span></span>\n<span class="line">	IsRead      <span class="token builtin">int</span>             <span class="token string">`gorm:&quot;column:is_read;not null;default:0;comment:&#39;是否查看&#39;&quot; json:&quot;is_read&quot; form:&quot;is_read&quot;`</span></span>\n<span class="line">	IsReal      <span class="token builtin">bool</span>            <span class="token string">`gorm:&quot;column:is_real;not null;default:1;comment:&#39;审核人和操作人是否同一人&#39;&quot; json:&quot;is_real&quot; form:&quot;is_real&quot;`</span></span>\n<span class="line">	Circle      <span class="token builtin">int</span>             <span class="token string">`gorm:&quot;column:circle;not null;default:1&quot; json:&quot;circle&quot; form:&quot;circle&quot;`</span></span>\n<span class="line">	Beizhu      <span class="token builtin">string</span>          <span class="token string">`gorm:&quot;column:beizhu;type:text;comment:&#39;备注&#39;&quot; json:&quot;beizhu&quot; form:&quot;beizhu&quot;`</span></span>\n<span class="line">	Concurrence carbon<span class="token punctuation">.</span>DateTime <span class="token string">`gorm:&quot;column:concurrence;not null;default:0;comment:&#39;并行查找解决字段， 部门 角色 指定 分组用&#39;&quot; json:&quot;concurrence&quot; form:&quot;concurrence&quot;`</span></span>\n<span class="line">	Emp         Emp             <span class="token string">`gorm:&quot;foreignKey:EmpID&quot;`</span>                                                  <span class="token comment">// 关联的Emp</span></span>\n<span class="line">	Entry       Entry           <span class="token string">`gorm:&quot;foreignKey:EntryID&quot;`</span>                                                <span class="token comment">// 关联的Entry</span></span>\n<span class="line">	Process     Process         <span class="token string">`gorm:&quot;foreignKey:ProcessID&quot;`</span>                                              <span class="token comment">// 关联的Process</span></span>\n<span class="line">	Flow        Flow            <span class="token string">`gorm:&quot;foreignKey:FlowID&quot;`</span>                                                 <span class="token comment">// 关联的Flow</span></span>\n<span class="line">	SubProcs    <span class="token punctuation">[</span><span class="token punctuation">]</span>Proc          <span class="token string">`gorm:&quot;foreignkey:EntryID;constraint:OnUpdate:CASCADE,OnDelete:NO ACTION&quot;`</span> <span class="token comment">// HasMany Proc</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>处理明细表:记录每个流程的流转记录，包括审核人、审核状态、审核内容等。</p>',40),l=[o];function i(p,u){return a(),s("div",null,l)}const r=n(e,[["render",i],["__file","models.html.vue"]]),d=JSON.parse('{"path":"/guides/models.html","title":"框架模型","lang":"zh-CN","frontmatter":{},"headers":[{"level":3,"title":"模型基础","slug":"模型基础","link":"#模型基础","children":[]},{"level":3,"title":"定义工作流","slug":"定义工作流","link":"#定义工作流","children":[]},{"level":3,"title":"Flow工作流模型","slug":"flow工作流模型","link":"#flow工作流模型","children":[]},{"level":3,"title":"Flowtype工作流类型","slug":"flowtype工作流类型","link":"#flowtype工作流类型","children":[]},{"level":3,"title":"Flowlink流程步骤流转轨迹","slug":"flowlink流程步骤流转轨迹","link":"#flowlink流程步骤流转轨迹","children":[]},{"level":3,"title":"Process流程步骤","slug":"process流程步骤","link":"#process流程步骤","children":[]},{"level":3,"title":"ProcessVar 步骤判断变量记录","slug":"processvar-步骤判断变量记录","link":"#processvar-步骤判断变量记录","children":[]},{"level":3,"title":"发起工作流","slug":"发起工作流","link":"#发起工作流","children":[]},{"level":3,"title":"Entry模型","slug":"entry模型","link":"#entry模型","children":[]},{"level":3,"title":"EntryData实例数据模型","slug":"entrydata实例数据模型","link":"#entrydata实例数据模型","children":[]},{"level":3,"title":"执行工作流","slug":"执行工作流","link":"#执行工作流","children":[]}],"git":{"updatedTime":1724063136000,"contributors":[{"name":"袁浩","email":"yuanhaozhuzhu@hotmail.com","commits":2}]},"filePathRelative":"guides/models.md"}');export{r as comp,d as data};
